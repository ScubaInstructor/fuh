FROM alpine:latest

# Installiere Python und pip
RUN apk add --no-cache python3 py3-pip
RUN apk add --no-cache build-base gcc python3-dev musl-dev

# Erstelle einen Symlink für Python
RUN ln -sf python3 /usr/bin/python

# Aktualisiere pip
RUN pip3 install --upgrade pip --break-system-packages


# Installiere Scapy und seine Abhängigkeiten
RUN apk add --no-cache libpcap-dev
RUN pip3 install scapy --break-system-packages
RUN pip3 install numpy --break-system-packages
RUN pip3 install scikit-learn --break-system-packages
RUN pip3 install python-dotenv --break-system-packages

# Erstelle den /app Ordner
RUN mkdir /app

# Kopiere die Dateien in den /app Ordner
COPY .env /app/.env
COPY sniffer.py /app/sniffer.py
COPY cicflowmeter /app/cicflowmeter

# Setze das Arbeitsverzeichnis auf /app
WORKDIR /app

CMD ["/usr/bin/python3", "sniffer.py"]
